<odoo>
    <template id="asset_master_report_template">
        <t t-call="web.internal_layout">
            <main>
                <div class="page">
                    <!-- 公司名稱 -->
                    <div style="text-align: center; font-size: 28px; font-weight: bold; margin-bottom: 10px;">
                        <t t-esc="company.name"/>
                    </div>
                    <!-- 標題與查詢條件 -->
                    <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 8px;">
                        <div style="flex: 1; text-align: center; font-size: 18px; font-weight: bold;">
                            財產目錄清冊
                        </div>
                        <div style="flex-shrink: 0; text-align: right; font-size: 12px;">
                            報表日期：<t t-esc="format_date(report_date)"/>
                        </div>
                    </div>
                    <div style="font-size: 12px; margin-bottom: 8px;">
                        <span t-if="category">資產類別：<t t-esc="category"/>　</span>
                        <span t-if="asset">財產編號：<t t-esc="asset"/>　</span>
                        <span t-if="department">保管部門：<t t-esc="department"/>　</span>
                        <span t-if="state">目前狀態：<t t-esc="state"/></span>
                    </div>
                    <!-- 表格 -->
                    <table style="width: 100%; border-collapse: collapse; font-size: 10px; line-height: 1.4; border: 0.5px solid #ddd;">
                        <thead style="background-color: #DCE6F1;">
                            <tr>
                                <th style="text-align: center; padding: 3px; width: 5%; border: 0.5px solid #ddd;">資產群組</th>
                                <th style="text-align: center; padding: 3px; width: 5%; border: 0.5px solid #ddd;">資產分類</th>
                                <th style="text-align: center; padding: 3px; width: 5%; border: 0.5px solid #ddd;">財產編號</th>
                                <th style="text-align: left; padding: 3px; width: 12%; border: 0.5px solid #ddd;">財產名稱</th>
                                <th style="text-align: center; padding: 3px; width: 4%; border: 0.5px solid #ddd;">入帳日期</th>
                                <th style="text-align: center; padding: 3px; width: 4%; border: 0.5px solid #ddd;">耐用月數</th>
                                <th style="text-align: center; padding: 3px; width: 4%; border: 0.5px solid #ddd;">剩餘月數</th>
                                <th style="text-align: right; padding: 3px; width: 3%; border: 0.5px solid #ddd;">數量</th>
                                <th style="text-align: right; padding: 3px; width: 6%; border: 0.5px solid #ddd;">取得金額</th>
                                <th style="text-align: right; padding: 3px; width: 6%; border: 0.5px solid #ddd;">本年折舊</th>
                                <th style="text-align: right; padding: 3px; width: 6%; border: 0.5px solid #ddd;">累計折舊</th>
                                <th style="text-align: right; padding: 3px; width: 6%; border: 0.5px solid #ddd;">帳面價值</th>
                                <th style="text-align: center; padding: 3px; width: 4%; border: 0.5px solid #ddd;">目前狀態</th>
                                <th style="text-align: center; padding: 3px; width: 4%; border: 0.5px solid #ddd;">保管部門</th>
                                <th style="text-align: center; padding: 3px; width: 4%; border: 0.5px solid #ddd;">保管人</th>
                                <th style="text-align: center; padding: 3px; width: 4%; border: 0.5px solid #ddd;">存放位置</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="docs" t-as="line">
                                <tr>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.group or ''"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.category_id.name if line.category_id else ''"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.asset_code or ''"/>
                                    </td>
                                    <td style="text-align: left; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.asset_name or ''"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.account_date and line.account_date.strftime('%y/%m/%d') or ''"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.depreciation_months or ''"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.remaining_months or ''"/>
                                    </td>
                                    <td style="text-align: right; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.quantity or ''"/>
                                    </td>
                                    <td style="text-align: right; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="'{:,.2f}'.format(line.amount) if line.amount else ''"/>
                                    </td>
                                    <td style="text-align: right; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="'{:,.2f}'.format(line.ytd_depreciation) if line.ytd_depreciation else ''"/>
                                    </td>
                                    <td style="text-align: right; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="'{:,.2f}'.format(line.accumulated_depreciation) if line.accumulated_depreciation else ''"/>
                                    </td>
                                    <td style="text-align: right; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="'{:,.2f}'.format(line.value) if line.value else ''"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="dict([('draft', '草稿'), ('confirm', '確認'), ('depreciation', '折舊中'), ('done', '折畢'), ('written_off', '已銷帳')]).get(line.state, '')"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.department_id.name if line.department_id else ''"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.responsible_id.name if line.responsible_id else ''"/>
                                    </td>
                                    <td style="text-align: center; padding: 3px; border: 0.5px solid #ddd;">
                                        <t t-esc="line.location or ''"/>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </div>
            </main>
        </t>
    </template>

    <record id="action_asset_master_report_pdf" model="ir.actions.report">
        <field name="name">財產目錄清冊</field>
        <field name="model">asset.master.report</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ji_accounting_asset.asset_master_report_template</field>
        <field name="print_report_name">'財產目錄清冊'</field>
        <field name="paperformat_id" ref="ji_accounting_report_tw.paperformat_tbs_landscape"/>
    </record>
</odoo> 